
Expression.Substitution.print_subt (Expression.match_expression ["x"; "y"] (Expression.parse_expression "foo x y") (Expression.parse_expression "no (bar z) (bar z)"))

Expression.Substitution.print_subt (Expression.match_expression ["x"; "y"] (Expression.parse_expression "foo x y") (Expression.parse_expression "foo a b"))

Expression.Substitution.print_subt (Expression.match_expression ["x"; "y"] (Expression.parse_expression "foo x x") (Expression.parse_expression "foo (bar z) (bar z)"))

Expression.Substitution.print_subt (Expression.match_expression ["x"; "y"] (Expression.parse_expression "foo x (foo y)") (Expression.parse_expression "foo (bar z) y"))

Expression.attemptRewrite ["x"; "y"] (Expression.Equality (Expression.parse_expression "foo x y", Expression.parse_expression "x y")) (Expression.parse_expression "foo (bar z) (bar w)")

Expression.Substitution.print_subt (Expression.match_expression ["y"] (Expression.parse_expression "foo x y") (Expression.parse_expression "foo a b"))

Expression.attemptRewrite ["y"] (Expression.Equality (Expression.parse_expression "foo x y", Expression.parse_expression "y")) (Expression.parse_expression "foo a b")
	
let myEqualities =
[ ("eq1", ["x"], Expression.Equality(Expression.parse_expression "foo x x", Expression.parse_expression "bar x"))
; ("eq2", ["x";"y"], Expression.Equality(Expression.parse_expression "bar x y", Expression.parse_expression "y"))
; ("eq3", ["x"], Expression.Equality(Expression.parse_expression "bozo x (foo x)", Expression.parse_expression "foo (bar x x)"))] ;; 

Expression.attemptRewrite ["x"; "y"] (Expression.Equality (Expression.parse_expression "bar x y", Expression.parse_expression "y")) (Expression.parse_expression "foo (bar a b) c")
Expression.Substitution.print_subt (Expression.match_expression ["x"; "y"] (Expression.parse_expression "bar x y") (Expression.parse_expression "foo (bar a b) c"))



Expression.attemptRewrite ["y"] (Expression.Equality (Expression.parse_expression "bar x y", Expression.parse_expression "y")) (Expression.parse_expression "bar a b")

Expression.Substitution.print_subt (Expression.match_expression ["y"] (Expression.parse_expression "bar y y") (Expression.parse_expression "bar a b"))
Expression.attemptRewrite ["y"] (Expression.Equality (Expression.parse_expression "bar y y", Expression.parse_expression "y")) (Expression.parse_expression "bar a b")



Expression.attemptRewrite ["x"] (Expression.Equality(Expression.parse_expression "foo x x", Expression.parse_expression "bar x")) (Expression.parse_expression "c");;


Expression.tryEqualities (Expression.parse_expression "foo x x") myEqualities;;

Expression.attemptRewrite ["x"] (Expression.Equality(Expression.parse_expression "foo x x", Expression.parse_expression "bar x")) (Expression.parse_expression "foo x x");;

Expression.tryEqualities (Expression.parse_expression "foo (bar a b) c") myEqualities;;

Expression.attemptRewrite ["x"] (Expression.Equality (Expression.parse_expression "foo x x", Expression.parse_expression "bar x")) (Expression.parse_expression "foo (bar a b) c")

	
	
		
